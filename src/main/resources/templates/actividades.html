<div th:fragment="contenido" class="h-100 d-flex flex-column ps-2 pe-2 pb-2">

    <div class="d-flex align-items-center justify-content-between mb-3 pt-3 flex-shrink-0">
        <div>
            <h4 class="fw-bold text-dark mb-0">Actividades</h4>
            <p class="text-muted small mb-0">Gestión de clases y cupos</p>
        </div>

        <div class="d-flex gap-2">
            <a class="btn btn-outline-danger btn-sm btn-modo-eliminar"
                    onclick="toggleModoEliminar()">
                <span>Eliminar</span>
            </a>

            <a class="btn btn-primary btn-sm shadow-sm d-flex align-items-center gap-2" onclick="abrirPanelActividad()">
                <i class="bi bi-plus-lg"></i>
                <span>Nueva actividad</span>
            </a>
        </div>
    </div>

    <div id="panelOverlayActividad"
         class="panel-overlay d-none"
         onclick="cerrarPanelActividad()">
        <div class="panel-container"
             onclick="event.stopPropagation()"
             th:insert="fragments/panel-actividades :: panelActividad">
        </div>
    </div>

    <div class="card custom-card border-0 flex-grow-1 overflow-hidden position-relative">
        
        <div class="table-responsive h-100 w-100 custom-scrollbar">
            <table class="table table-hover align-middle mb-0" style="width: 100%;">
                
                <thead class="bg-white" style="position: sticky; top: 0; z-index: 10;">
                    <tr class="text-secondary small text-uppercase">
                        <th class="ps-4 py-3 bg-light border-bottom">Actividad</th>
                        <th class="py-3 bg-light border-bottom">Instructor</th>
                        <th class="py-3 bg-light border-bottom">Cant./Cupos</th>
                        <th class="py-3 bg-light border-bottom">Días</th>
                        <th class="py-3 bg-light border-bottom">Horario</th>
                        <th class="pe-4 py-3 bg-light border-bottom text-center" style="width: 120px;">Acciones</th>
                    </tr>
                </thead>

                <tbody class="border-top-0">
                    <tr th:each="actividad : ${actividades}">
                        
                        <td class="ps-4 fw-medium" th:text="${actividad.nombre}"></td>
                        
                        <td>
                            <div class="d-flex flex-wrap gap-1">
                                <span class="badge bg-light text-dark border fw-normal" 
                                      th:each="d : ${actividad.dictados}">
                                    <span th:text="${d.instructor.nombre + ' ' + d.instructor.apellido}"></span>
                                </span>
                            </div>
                        </td>

                        <td>
                            <span class="badge bg-success-light text-success border border-success border-opacity-25"
                                  th:text="${#lists.size(actividad.dictados) + '/' + actividad.cupoMaximo}">
                            </span>
                        </td>

                        <td></td>

                        <td></td>

                        <td class="pe-4 text-center">
                            <div class="acciones-td position-relative d-flex justify-content-center align-items-center">
                                <button type="button"
                                        class="btn btn-sm btn-outline-primary btn-editar-row"
                                        th:attr="data-id=${actividad.idActividad}, 
                                                 data-nombre=${actividad.nombre}, 
                                                 data-cupo-maximo=${actividad.cupoMaximo}, 
                                                 data-precio=${actividad.precio}"
                                        onclick="abrirPanelEditarActividad(this)">
                                    <i class="bi bi-pencil"></i>
                                </button>
                                
                                <button type="button"
                                        class="btn btn-sm btn-outline-danger btn-eliminar position-absolute"
                                        th:attr="data-id=${actividad.idActividad},
                                                 data-nombre=${actividad.nombre},
                                                 data-cupoMaximo=${actividad.cupoMaximo},
                                                 data-precio=${actividad.precio},
                                                 data-url='/actividades/eliminar'"
                                        onclick="abrirPanelEliminar(this)">
                                    <i class="bi bi-trash"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div id="panelEliminarOverlay"
         class="panel-overlay d-none"
         onclick="cerrarPanelEliminar()">
        <div class="panel-container"
             onclick="event.stopPropagation()"
             th:insert="fragments/panel-eliminar :: panelEliminar">
        </div>
    </div>

</div>