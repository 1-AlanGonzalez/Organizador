<div th:fragment="contenido">

    <!-- Header -->
    <div class="d-flex align-items-center mb-4">

        <h4 class="section-title mb-0">Clientes</h4>

        <div class="ms-auto d-flex gap-2">

            <button class="btn btn-outline-danger btn-sm btn-modo-eliminar"
                    onclick="toggleModoEliminar()">
                Eliminar
            </button>
            <a th:href="@{/clientes/nuevo}" class="btn btn-outline-success btn-sm">
                + Inscribir Cliente
            </a>
        </div>
    </div>

    <!-- Filtro -->
    <div class="mb-3 d-flex justify-content-between">
        <input 
            id="filtroClientes"
            type="text"
            class="form-control form-control-sm"
            style="max-width: 250px;"
            placeholder="Filtrar clientes">
    </div>


    <!-- Tabla -->
    <div class="card custom-card">
        <div class="table-responsive">
            <table id="tablaClientes" class="table table-hover table-sm align-middle mb-0">
                <thead>
                    <tr class="text-muted small text-uppercase">
                        <th>Nombre</th>
                        <th>Apellido</th>
                        <th>Actividad</th>
                        <th>Fecha de pago</th>
                        <th>Estado</th>
                        <th>Acciones</th>
                    </tr>
                </thead>

               <tbody>
    <tr th:each="c : ${clientes}"> 
        <td th:text="${c.nombre}" class="fw-medium"></td>
        <td th:text="${c.apellido}"></td>
        <td>
            <div class="d-flex flex-wrap gap-1">
                <span th:each="insc : ${c.inscripciones}" 
                      class="badge bg-light text-dark border small"
                      th:text="${insc.actividad.nombre}">
                </span>
            </div>
        </td>

        <td>
                <div th:each="insc : ${c.inscripciones}">
                    <span class="small text-secondary"
                          th:if="${insc.fechaUltimoPago != null}"
                          th:text="${#temporals.format(insc.fechaUltimoPago, 'dd/MM/yyyy')}">
                    </span>
                </div>
        </td>

        <td>
            <span th:if="${c.adeuda()}" class="badge bg-danger-light text-danger">Adeuda</span>
            <span th:if="${!c.adeuda()}" class="badge bg-success-light text-success">Al d√≠a</span>
        </td>

        <td >
            <div class="d-flex align-items-center gap-2">
                <a th:href="@{/clientes/editar/{id}(id=${c.idCliente})}" 
                   class="btn btn-sm btn-outline-primary btn-editar-row">
                    <i class="bi bi-pencil"></i>
                </a>

                <button type="button"
                        class="btn btn-sm btn-outline-danger btn-eliminar"
                        th:attr="data-id=${c.idCliente}, data-nombre=${c.nombre}"
                        onclick="abrirPanelEliminar(this)">
                    <i class="bi bi-trash"></i>
                </button>
            </div>
        </td>
    </tr>
</tbody>

            </table>
            <div id="panelEliminarOverlay"
                class="panel-overlay d-none"
                onclick="cerrarPanelEliminar()">

                <div class="panel-container"
                    onclick="event.stopPropagation()"
                    th:insert="fragments/panel-eliminar :: panelEliminar">
                </div>
            </div>
        </div>
    </div>

</div>
